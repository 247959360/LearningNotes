{"version":3,"file":"vue.js","sources":["../src/util/index.js","../src/observer/array.js","../src/observer/index.js","../src/init/state.js","../src/compileToFunction/index.js","../src/lifecycle/lifecycle.js","../src/init/init.js","../src/render/render.js","../src/index.js"],"sourcesContent":["export function isObject(data) {\n  if (typeof data === 'object' && data !== null) {\n    return true;\n  } else {\n    return false;\n  }\n}\n\nexport function def(data, key, value) {\n  Object.defineProperty(data, key, {\n    // 不可被枚举\n    enumerable: false,\n    // 不可以被在修改\n    configurable: false,\n    // 值\n    value: value\n  })\n}","\nlet oldArrayMethods = Array.prototype\nexport let arrayMethods = Object.create(oldArrayMethods)\n\n// 查找原型的方法  先从 __proto__ 上查找\n// 找不到的话  再去 prototype上查找\n// \n// 原型链看一下\nconst methods = [\n  'unshift',\n  'shift',\n  'pop',\n  'push',\n  'splice',\n  'sort',\n  'reverse'\n]\n\nmethods.forEach((method, index) => {\n  arrayMethods[method] = function(...args) {\n    console.log('用户改变了数组')\n    const result = oldArrayMethods[method].apply(this, args)\n    let ob = this.__ob__\n    console.log(ob, 'ob方法')\n    let inserted // 插入的元素是对象还需要在劫持\n    // 获取到插入的数据\n    switch (method) {\n      case 'push':\n      case 'unshift':\n        inserted = args\n        break;\n      case 'splice':\n        inserted = args.slice(2) // arr.splice(0,1,{name:1})\n      default:\n        break;\n    }\n    if(inserted) {\n      console.log(inserted, 'inserted')\n      ob.observerArray(inserted)\n    }\n    return result\n  }\n})","// data中的数据 重新定义\nimport { isObject, def } from '../util/index'\nimport { arrayMethods } from './array'\n\n// 递归处理 里面的数据可能很复杂\nclass Observer {\n  constructor(value) {\n    // 如果数据的层次过多 需要递归的去解析对象中的属性  依次增加 get和set\n    // vue3 使用了proxy 就不需要依次的递归了 支持监听整个对象 也不需要set和get\n    // 给每一个监控过的对象都加一个 __ob__ 属性 指向当前的Observer实例\n    // value.__ob__ = this\n    def(value, '__ob__', this)\n    // Object.defineProperty(value, '__ob__', {\n    //   // 不可被枚举\n    //   enumerable: false,\n    //   // 不可以被在修改\n    //   configurable: false,\n    //   // 值\n    //   value: this\n    // })\n    if(Array.isArray(value)) {\n      // 改变数组的原型上的方法 7个变异的方法  其他没有重写，还是直接走数组原先的方法\n      // 不会被拦截\n      value.__proto__ = arrayMethods\n      // setArray()\n      this.observerArray(value)\n    } else {\n      this.walk(value)\n    }\n  }\n  walk(data) {\n    let keys = Object.keys(data)\n    keys.forEach((key) => {\n      defineReactive(data, key, data[key])\n    })\n  }\n  observerArray(value) {\n    // 判断数组是否还有对象  也是需要进行劫持的\n    value.forEach((item, index) => {\n      observer(item)\n    })\n  }\n}\n\nexport function observer(data) {\n  // 数据的劫持\n  // console.log(\"数据的劫持\")\n  // 判断是否是对象\n  let isObj = isObject(data)\n  // console.log(isObj)\n  if(!isObj) {\n    return\n  }\n  // 观测这个对象\n  return new Observer(data)\n}\n\n// 定义响应式数据\n// data对象里面的key 定义为响应式数据\nfunction defineReactive(data, key, value) {\n  // console.log(key, value)\n  observer(value)\n  Object.defineProperty(data, key, {\n    // 获取值的时候 做一些操作\n    get() {\n      return value\n    },\n    // 设置值的时候 做一些操作\n    set(newValue) {\n      console.log(\"重新设置了数据了\")\n      if(newValue === value) return\n      // 设置的值是对象  还需要再次进行数据的劫持\n      observer(newValue)\n      value = newValue\n    }\n  })\n}\n\nexport function initSet(Vue, vm) {\n  Vue.prototype.$set = function(target, key, value) {\n    // 响应式处理\n    defineReactive(target, key, value)\n    // vm._data = target\n  }\n}\n\n// function setArray() {\n//   let methods = [\n//     'unshift',\n//     'shift',\n//     'pop',\n//     'push',\n//     'splice',\n//     'sort',\n//     'reverse'\n//   ]\n//   let oldPrototype = Array.prototype\n//   methods.forEach((method) => {\n//     Array.prototype[method] = function(value) {\n//       console.log(oldPrototype)\n//       // 这个会导致死循环\n//       // let r = oldPrototype[method].call(this, value)\n//       // return r\n//     }\n//   })\n// }\n// for(let i = 0; i < methods.length; i++) {\n//   Array.prototype[methods[i]] = function(value) {\n//     console.log(value)\n//     // oldPrototype\n//     // oldPrototype[methods[i]].call(this, value)\n//     observer(value)\n//   }\n// }\n","// 初始化状态\nimport { observer } from '../observer/index.js'\nexport function initState(vm) {\n  const opts = vm.$options\n  // console.log(opts)\n  // vue的数据来源 属性 方法 数据 计算属性 watch\n  // 初始化 先属性 在方法\n  if(opts.props) {\n    initProps(vm)\n  }\n  if(opts.methods) {\n    initMethod(vm)\n  }\n  if(opts.data) {\n    initData(vm)\n    console.log(\"111111xxxxx\")\n    let keys = Object.keys(vm._data)\n    // 这边也是需要进行递归处理的\n    // 做一个代理  让用户可以直接通过 实例.xx 获取属性\n    keys.forEach((key, index) => {\n      // 也就是做一个引用而已  还是指向vm._data里面的数据\n      proxy(vm, '_data', key)\n    })\n  }\n  if(opts.data) {\n    initComputed(vm)\n  }\n  if(opts.data) {\n    initWatch(vm)\n  }\n}\n\nfunction proxy(vm, source, key) {\n  Object.defineProperty(vm, key, {\n    get() {\n      return vm[source][key]\n    },\n    set(newValue) {\n      vm[source][key] = newValue\n    }\n  })\n}\n\nfunction initProps(vm) {\n\n}\n\nfunction initMethod(vm) {\n  \n}\n\nfunction initData(vm) {\n  console.log('初始化数据')\n  let data = vm.$options.data\n  // data里面的this指向还是实例\n  data = vm._data = typeof data == 'function' ? data.call(vm) : data\n  // 初始化数据后，处理数据 让用户可以直接修改data里面的数据\n  // 将数据挂载到 vm._data 上面\n  // console.log(vm._data, 'vm._data')\n  // 对象劫持 用户改变了数据 我希望可以得到通知刷新页面\n  observer(data) // 响应式原理\n}\n\nfunction initComputed(vm) {\n  \n}\n\nfunction initWatch(vm) {\n  \n}\n","// ast语法树  是用对象来描述原生语法的  虚拟dom 用对象来描述dom节点\nconst ncname = `[a-zA-Z_][\\\\-\\\\.0-9_a-zA-Z]*`;  // abc-aaa\nconst qnameCapture = `((?:${ncname}\\\\:)?${ncname})`; // <aaa:abc> \nconst startTagOpen = new RegExp(`^<${qnameCapture}`); // 标签开头的正则 捕获的内容是标签名\nconst endTag = new RegExp(`^<\\\\/${qnameCapture}[^>]*>`); // 匹配标签结尾的 </div>\nconst attribute = /^\\s*([^\\s\"'<>\\/=]+)(?:\\s*(=)\\s*(?:\"([^\"]*)\"+|'([^']*)'+|([^\\s\"'=<>`]+)))?/; // 匹配属性的\nconst startTagClose = /^\\s*(\\/?)>/; // 匹配标签结束的 > 自闭和标签\nconst defaultTagRE = /\\{\\{((?:.|\\r?\\n)+?)\\}\\}/g // 匹配vue的模版语法 {{}}\n\n// 正则\n// 匹配标签、匹配属性\nlet root;\nlet currentParent;\nlet stack = [];\nconst ELEMENT_TYPE = 1;\nconst TEXT_TYPE = 3;\n\nfunction createASTElement(tagName,attrs){\n  return {\n      tag:tagName,\n      type:ELEMENT_TYPE,\n      children:[],\n      attrs,\n      parent:null\n  }\n}\n\nfunction start(tagName, attrs) {\n  let element = createASTElement(tagName,attrs);\n  if(!root){\n      root = element;\n  }\n  currentParent = element;\n  stack.push(element);\n}\n\nfunction end(tagName) {\n  let element = stack.pop();\n  currentParent = stack[stack.length-1];\n  if(currentParent){\n      element.parent = currentParent;\n      currentParent.children.push(element);\n  }\n}\n\nfunction chars(text) {\n  text = text.replace(/\\s/g,'');\n  if(text){\n      currentParent.children.push({\n          type:TEXT_TYPE,\n          text\n      })\n  }\n}\n\nfunction parseHTML(html){\n  while(html){\n      let textEnd = html.indexOf('<');\n      if(textEnd == 0){\n          const startTagMatch = parseStartTag();\n          if(startTagMatch){\n              start(startTagMatch.tagName,startTagMatch.attrs);\n              continue;\n          }\n          const endTagMatch = html.match(endTag);\n          if(endTagMatch){\n              advance(endTagMatch[0].length);\n              end(endTagMatch[1]);\n              continue;\n          }\n      }\n      let text;\n      if(textEnd >= 0){\n          text = html.substring(0,textEnd);\n      }\n      if(text){\n          advance(text.length);\n          chars(text);\n      }\n  }\n  function advance(n){\n      html = html.substring(n);\n  }\n  function parseStartTag(){\n      const start = html.match(startTagOpen);\n      if(start){\n          const match = {\n              tagName:start[1],\n              attrs:[]\n          }\n          advance(start[0].length);\n          let attr,end;\n          while(!(end = html.match(startTagClose)) && (attr = html.match(attribute))){\n              advance(attr[0].length);\n              match.attrs.push({name:attr[1],value:attr[3]});\n          }\n          if(end){\n              advance(end[0].length);\n              return match\n          }\n      }\n  }\n}\nexport function compileToFunction(template){\n  parseHTML(template);\n  // console.log(root)\n  // 需要将ast语法树生成最终的render函数  就是字符串拼接（模版引擎）\n  let code = generate(root);\n  // console.log(code)\n  let render = `with(this){return ${code}}`;\n  let renderFn = new Function(render);\n  console.log(renderFn)\n  return renderFn\n}\n\nfunction gen(node) {\n  if (node.type == 1) {\n      return generate(node);\n  } else {\n      let text = node.text\n      if(!defaultTagRE.test(text)){\n          return `_v(${JSON.stringify(text)})`\n      }\n      let lastIndex = defaultTagRE.lastIndex = 0\n      let tokens = [];\n      let match,index;\n      \n      while (match = defaultTagRE.exec(text)) {\n          index = match.index;\n          if(index > lastIndex){\n              tokens.push(JSON.stringify(text.slice(lastIndex,index)));\n          }\n          tokens.push(`_s(${match[1].trim()})`)\n          lastIndex = index + match[0].length;\n      }\n      if(lastIndex < text.length){\n          tokens.push(JSON.stringify(text.slice(lastIndex)))\n      }\n      return `_v(${tokens.join('+')})`;\n  }\n}\nfunction getChildren(el) { // 生成儿子节点\n  const children = el.children;\n  if (children) {\n      return `${children.map(c=>gen(c)).join(',')}`\n  } else {\n      return false;\n  }\n}\nfunction genProps(attrs){ // 生成属性\n  let str = '';\n  for(let i = 0; i<attrs.length; i++){\n      let attr = attrs[i];\n      if(attr.name === 'style'){\n          let obj = {}\n          attr.value.split(';').forEach(item=>{\n              let [key,value] = item.split(':');\n              obj[key] = value;\n          })\n          attr.value = obj;\n      }\n      str += `${attr.name}:${JSON.stringify(attr.value)},`;\n  }\n  return `{${str.slice(0,-1)}}`;\n}\nfunction generate(el) {\n  let children = getChildren(el);\n  let code = `_c('${el.tag}',${\n      el.attrs.length?`${genProps(el.attrs)}`:'undefined'\n  }${\n      children? `,${children}`:''\n  })`;\n  return code;\n}\n","import { Watcher } from '../observer/watcher'\nexport function mountComponent(vm, el) {\n  const options = vm.$options\n  // 真是的el挂载到$el\n  vm.$el = el\n  console.log(vm)\n  // 渲染页面\n  // 更新组件 \n  let updateComponent = () => { // 无论是渲染还是更新都会调用此方法\n    // 返回的是虚拟的dom\n    // 虚拟的dom生成真实的dom\n    // vm._render() 获取到的是虚拟的节点\n    vm._update(vm._render())\n  }\n  // 渲染watcher 每个组件都有一个watcher\n  // 默认渲染wathcer是没有回调的\n  new Watcher(vm, updateComponent, ()=> {}, true) // 这是一个渲染watcher\n}\n\nexport function lifecycleMixin(Vue) {\n  Vue.prototype._update = function(vnode) {\n    \n  }\n}\n","import { initState } from './state.js'\nimport { initSet } from '../observer/index.js'\nimport { createLogger } from 'vuex'\nimport { compileToFunction } from '../compileToFunction/index.js'\nimport { mountComponent } from '../lifecycle/lifecycle.js'\n// 在原型上添加一个init方法\nexport function initMixin(Vue) {\n  Vue.prototype._init = function(options) {\n    // 数据的劫持 当前的实例就是this\n    const vm = this\n    // this.$options 指代的就是用户传递的属性\n    vm.$options = options\n    \n    initSet(Vue)\n    // 初始化状态\n    initState(vm)\n\n    \n\n\n    // 用户传入了人el属性  那么就需要渲染数据\n    if(vm.$options.el) {\n      vm.$mount(vm.$options.el)\n    }\n  }\n  Vue.prototype.$mount = function(el) {\n    const vm = this\n    const options = vm.$options\n    el = document.querySelector(el)\n    // 默认会先查找render，没有render，会采用template， temeplate也没有会使用el中的内容\n    if(!options.render) {\n      // 对模版进行编译\n      let template = options.template\n      if(!template && el) {\n        // el.outerHTML包含了el所有的元素\n        template = el.outerHTML\n      }\n      // console.log(template)\n      // 把template变成虚拟节点\n      const render = compileToFunction(template)\n      options.render = render\n    }\n    // 需要将当前的组件 挂载这个组件\n    mountComponent(vm, el)\n  }\n}\n","export function renderMixin(Vue) {\n  Vue.prototype._render = function() {\n    \n  }\n}\n","// Vue的核心代码 这个文件相当于整合的功能\nimport { initMixin } from './init/init'\nimport { renderMixin } from './render/render'\nimport { lifecycleMixin } from './lifecycle/lifecycle'\nfunction Vue(options) {\n  // 进行vue的初始化\n  this._init(options)\n}\n// let vue = require('vue')\n// console.log(vue)\n// 通过引入文件的方式，给vue原型上添加方法\n// 执行一下 把大 Vue传递进去\ninitMixin(Vue)\nrenderMixin(Vue)\nlifecycleMixin(Vue)\n\n// initRender(Vue)\nexport default Vue\n\n// function React() {\n//   console.log('react')\n//   this.a = 'sgjm'\n//   this._init()\n// }\n\n// // 原型上的方法 可以获取当前的实例\n// React.prototype._init = function() {\n//   console.log(this)\n// }\n\n// new React()\n"],"names":["isObject","data","def","key","value","Object","defineProperty","enumerable","configurable","oldArrayMethods","Array","prototype","arrayMethods","create","methods","forEach","method","index","console","log","args","result","apply","ob","__ob__","inserted","slice","observerArray","Observer","isArray","__proto__","walk","keys","defineReactive","item","observer","isObj","get","set","newValue","initSet","Vue","vm","$set","target","initState","opts","$options","props","initData","_data","proxy","source","call","ncname","qnameCapture","startTagOpen","RegExp","endTag","attribute","startTagClose","defaultTagRE","root","currentParent","stack","ELEMENT_TYPE","TEXT_TYPE","createASTElement","tagName","attrs","tag","type","children","parent","start","element","push","end","pop","length","chars","text","replace","parseHTML","html","textEnd","indexOf","startTagMatch","parseStartTag","endTagMatch","match","advance","substring","n","attr","name","compileToFunction","template","code","generate","render","renderFn","Function","gen","node","test","JSON","stringify","lastIndex","tokens","exec","trim","join","getChildren","el","map","c","genProps","str","i","obj","split","mountComponent","options","$el","lifecycleMixin","_update","vnode","initMixin","_init","$mount","document","querySelector","outerHTML","renderMixin","_render"],"mappings":"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"}